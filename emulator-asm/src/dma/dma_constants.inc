.intel_syntax noprefix

# GENERAL CONSTANTS

.equ MAX_MTRACE_REGS_ACCESS_SIZE, (2 + 2 + 3) * 8
.equ CHUNK_SIZE, (1 << 18)
.equ MAX_TRACE_CHUNK_INFO, ((44*8) + 32)
.equ MAX_BYTES_DIRECT_MTRACE, 256
.equ MAX_BYTES_MTRACE_STEP, (MAX_BYTES_DIRECT_MTRACE + MAX_MTRACE_REGS_ACCESS_SIZE)
.equ MAX_CHUNK_TRACE_SIZE, CHUNK_SIZE * MAX_BYTES_MTRACE_STEP + MAX_TRACE_CHUNK_INFO

# 1 encoded + 2 prewrites + 2 src reads
.equ MAX_DMA_EXTRA_BYTES, (2 + 2 + 1) * 8
.equ MAX_DMA_BYTES_DIRECT_MTRACE, (MAX_BYTES_DIRECT_MTRACE - MAX_DMA_EXTRA_BYTES)
.equ MAX_DMA_MT_MARGIN, (MAX_DMA_BYTES_DIRECT_MTRACE + MAX_DMA_EXTRA_BYTES)

.equ EXTRA_PARAMETER_ADDR, 0xA0000F00

# ENCODE CONSTANTS
#
#                     bits  offset  mask
#                     ----  ------  --------
# pre_count:  0-7        3       0  0x0000_0000_0000_0007
# post_count: 0-7        3       3  0x0000_0000_0000_0038
# pre_writes: 0,1,2      2       6  0x0000_0000_0000_00C0
# dst_offset: 0-7        3       8  0x0000_0000_0000_0700
# src_offset: 0-7        3      11  0x0000_0000_0000_3800
# double_src_pre: 0,1    1      14  0x0000_0000_0000_4000
# double_src_post: 0,1   1      15  0x0000_0000_0000_8000
# extra_src_reads: 0-3   2      16  0x0000_0000_0003_0000 
# src64_inc_by_pre:      1      18  0x0000_0000_0004_0000
# unaligned_dst_src:     1      19  0x0000_0000_0008_0000
# pre_count: 0-7         3      29  only for optimization PRE_AND_LOOP_BYTES
# loop_count            32       0  0xFFFF_FFFF_0000_0000

# BITS 31,32,32 

.equ PRE_COUNT_MASK,          0x0000000000000007
.equ POST_COUNT_MASK,         0x0000000000000038
.equ PRE_WRITES_MASK,         0x00000000000000C0
.equ DST_OFFSET_MASK,         0x0000000000000700
.equ SRC_OFFSET_MASK,         0x0000000000003800
.equ DOUBLE_SRC_PRE_MASK,     0x0000000000004000
.equ DOUBLE_SRC_POST_MASK,    0x0000000000008000
.equ EXTRA_SRC_READS_MASK,    0x0000000000030000
.equ SRC64_INC_BY_PRE_MASK,   0x0000000000040000
.equ UNALIGNED_DST_SRC_MASK,  0x0000000000080000
.equ LOOP_COUNT_MASK,         0xFFFFFFFF00000000
.equ ONLY_LOOP_COUNT_MASK,    0xFFFFFFFF00000000

# PRE_COUNT_SBITS         0
.equ POST_COUNT_SBITS,          3
.equ PRE_WRITES_SBITS,          6
.equ DST_OFFSET_SBITS,          8
.equ SRC_OFFSET_SBITS,          11
.equ DOUBLE_SRC_PRE_SBITS,      14
.equ DOUBLE_SRC_POST_SBITS,     15
.equ EXTRA_SRC_READS_SBITS,     16
.equ SRC64_INC_BY_PRE_SBITS,    18
.equ UNALIGNED_DST_SRC_SBITS,   19
.equ LOOP_COUNT_SBITS,          32
.equ PRE_AND_LOOP_BYTES_SBITS,  29
.equ ALIGN_MASK,                0xFFFFFFFFFFFFFFF8
.equ MOPS_BLOCK_WORDS_SBITS,    36
.equ MOPS_BLOCK_ONE_WORD,       0x0000001000000000       
.equ MOPS_BLOCK_READ,           0x0000000A00000000
.equ MOPS_BLOCK_WRITE,          0x0000000B00000000
.equ MOPS_ALIGNED_READ,         0x0000000C00000000
.equ MOPS_ALIGNED_WRITE,        0x0000000D00000000
.equ MOPS_ALIGNED_BLOCK_READ,   0x0000000E00000000
.equ MOPS_ALIGNED_BLOCK_WRITE,  0x0000000F00000000
